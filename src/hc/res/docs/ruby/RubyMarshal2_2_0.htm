<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <!-- classpage -- >
    <!-- RD version: 0.39.0  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <meta name='description' content='  Module : Marshal  -   Ruby 2.2.0 ' />
  <meta content="2017-09-09 18:34:22 -0500" http-equiv="change-date" />
  <!-- rel_prefix  = ''  ENV['RDOC_FOR_WEBSITE']   = true-->
    
    
    
  <!-- rel_prefix = '.'   asset_rel_prefix = ''  --> 
  <title>Module: Marshal (Ruby 2.2.0) </title>
  <link rel="stylesheet" href="/css/associated.css" type="text/css" >
  <!-- link rel="stylesheet" href=".css/obf.css"  -->
  <link rel="stylesheet" href="/css/inuit.css" >
  <link rel="stylesheet" href="/css/grid.inuit.css" >
  <link rel="stylesheet" href="/css/2011.css" type="text/css" >
  <link rel="stylesheet" href="/css/rdoc.css" type="text/css" >
    <link rel="stylesheet" href="/css/carbon17.css" type="text/css" >


  <script src="/js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 


   
<script src="/js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 

  <style type='text/css'>

    #vulns-alert #vulns{
      background-color: #c33 ! important;
      width: 100%;
      text-align: center;
   }
   
   #vulns-alert #vulns a {
    color: #F99 ! important;
   }
 </style>

   <link rel="stylesheet" href="/css/extra.css" type="text/css" >
  <script  src="/js/extra.js"  ></script>


</head>

<body id="top" class="module rdocstar">

<div id='actionbar' >
<div class='wrapper'>
  <ul class='grids g0'>
	<li class='grid-2' ><a href='/' target='_top' >Home</a></li>
	<li class='grid-2' ><a href='/core-2.2.0' target='_top' >Core 2.2.0</a></li>
	<li class='grid-2' ><a href='/stdlib-2.2.0' target='_top' >Std-lib 2.2.0</a></li>

   <li class='grid-2' ><a href='/downloads' target='_top' >Downloads</a></li>
	 <li class='grid-5 right' id='rd-action-search'><form id="searchbox_011815814100681837392:wnccv6st5qk" action="http://ruby-doc.com/search.html"><input type="hidden" name="cx" value="011815814100681837392:wnccv6st5qk" ><input  id='rd-search-input' name="q" type="text" size="20" >&#160;&#160;<input type="submit" name="sa" value="Search" ><input type="hidden" name="cof" value="FORID:9" ></form></li>
	</ul>
</div>
<span id='vulns-alert'></span>
<div id='versionheader'>
<p>Support for the Ruby 2.2 series will end March 2018. See <a href='https://www.ruby-lang.org/en/news/2017/04/01/support-of-ruby-2-1-has-ended/'>here</a> for reference.</p>
</div>
</div> <!-- end action bar -->
 <div class='wrapper'>
  
   <!-- carbon17 added here 2017-09-09 -->
 
   <script src="//m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
<div class="bsa-cpc"></div>
<script>
  (function(){
    if(typeof _bsa !== 'undefined' && _bsa) {
    _bsa.init('default', 'CKYD627W', 'placement:rubydocorg', {
      target: '.bsa-cpc',
      align: 'horizontal',
      disable_css: 'true'
    });
      }
  })();
</script>

 

   <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
          
          
          <!-- br><a id='alternateFormatLink' class='rotate' href="#" onclick='matchingYardUrl()'>YARD version</a -->
          
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul id='file-metadata'>

          
          
          
          <li class='in-file'>marshal.c</li>      
            
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-dump">::dump</a></li>
          
          <li><a href="#method-c-load">::load</a></li>
          
          <li><a href="#method-c-restore">::restore</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul id='files'>
        
          
          <li class="file"><a href="./_lib/racc/rdoc/grammar_en_rdoc.html">grammar.en.rdoc</a></li>
        
          
          <li class="file"><a href="./_test/rdoc/test_ja_rdoc.html">test.ja.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/contributing_rdoc.html">contributing.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/contributors_rdoc.html">contributors.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/dtrace_probes_rdoc.html">dtrace_probes.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/globals_rdoc.html">globals.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/keywords_rdoc.html">keywords.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/maintainers_rdoc.html">maintainers.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/marshal_rdoc.html">marshal.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/regexp_rdoc.html">regexp.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/security_rdoc.html">security.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/standard_library_rdoc.html">standard_library.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax_rdoc.html">syntax.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/assignment_rdoc.html">assignment.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/calling_methods_rdoc.html">calling_methods.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/control_expressions_rdoc.html">control_expressions.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/exceptions_rdoc.html">exceptions.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/literals_rdoc.html">literals.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/methods_rdoc.html">methods.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/miscellaneous_rdoc.html">miscellaneous.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/modules_and_classes_rdoc.html">modules_and_classes.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/precedence_rdoc.html">precedence.rdoc</a></li>
        
          
          <li class="file"><a href="./doc/syntax/refinements_rdoc.html">refinements.rdoc</a></li>
        
          
          <li class="file"><a href="./sample/drb/README_ja_rdoc.html">README.ja.rdoc</a></li>
        
          
          <li class="file"><a href="./sample/drb/README_rdoc.html">README.rdoc</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
          
          
          
          <li><a href="./ArgumentError.html">ArgumentError</a></li>
        
          
          
          <li><a href="./Array.html">Array</a></li>
        
          
          
          <li><a href="./BasicObject.html">BasicObject</a></li>
        
          
          
          <li><a href="./Bignum.html">Bignum</a></li>
        
          
          
          <li><a href="./Binding.html">Binding</a></li>
        
          
          
          <li><a href="./Class.html">Class</a></li>
        
          
          
          <li><a href="./Comparable.html">Comparable</a></li>
        
          
          
          <li><a href="./Complex.html">Complex</a></li>
        
          
          
          <li><a href="./Complex/compatible.html">Complex::compatible</a></li>
        
          
          
          <li><a href="./ConditionVariable.html">ConditionVariable</a></li>
        
          
          
          <li><a href="./Continuation.html">Continuation</a></li>
        
          
          
          <li><a href="./Data.html">Data</a></li>
        
          
          
          <li><a href="./Dir.html">Dir</a></li>
        
          
          
          <li><a href="./ENV.html">ENV</a></li>
        
          
          
          <li><a href="./EOFError.html">EOFError</a></li>
        
          
          
          <li><a href="./Encoding.html">Encoding</a></li>
        
          
          
          <li><a href="./Encoding/CompatibilityError.html">Encoding::CompatibilityError</a></li>
        
          
          
          <li><a href="./Encoding/Converter.html">Encoding::Converter</a></li>
        
          
          
          <li><a href="./Encoding/ConverterNotFoundError.html">Encoding::ConverterNotFoundError</a></li>
        
          
          
          <li><a href="./Encoding/InvalidByteSequenceError.html">Encoding::InvalidByteSequenceError</a></li>
        
          
          
          <li><a href="./Encoding/UndefinedConversionError.html">Encoding::UndefinedConversionError</a></li>
        
          
          
          <li><a href="./EncodingError.html">EncodingError</a></li>
        
          
          
          <li><a href="./Enumerable.html">Enumerable</a></li>
        
          
          
          <li><a href="./Enumerator.html">Enumerator</a></li>
        
          
          
          <li><a href="./Enumerator/Generator.html">Enumerator::Generator</a></li>
        
          
          
          <li><a href="./Enumerator/Lazy.html">Enumerator::Lazy</a></li>
        
          
          
          <li><a href="./Enumerator/Yielder.html">Enumerator::Yielder</a></li>
        
          
          
          <li><a href="./Errno.html">Errno</a></li>
        
          
          
          <li><a href="./Exception.html">Exception</a></li>
        
          
          
          <li><a href="./FalseClass.html">FalseClass</a></li>
        
          
          
          <li><a href="./Fiber.html">Fiber</a></li>
        
          
          
          <li><a href="./FiberError.html">FiberError</a></li>
        
          
          
          <li><a href="./File.html">File</a></li>
        
          
          
          <li><a href="./File/Constants.html">File::Constants</a></li>
        
          
          
          <li><a href="./File/Stat.html">File::Stat</a></li>
        
          
          
          <li><a href="./FileTest.html">FileTest</a></li>
        
          
          
          <li><a href="./Fixnum.html">Fixnum</a></li>
        
          
          
          <li><a href="./Float.html">Float</a></li>
        
          
          
          <li><a href="./FloatDomainError.html">FloatDomainError</a></li>
        
          
          
          <li><a href="./GC.html">GC</a></li>
        
          
          
          <li><a href="./GC/Profiler.html">GC::Profiler</a></li>
        
          
          
          <li><a href="./Hash.html">Hash</a></li>
        
          
          
          <li><a href="./IO.html">IO</a></li>
        
          
          
          <li><a href="./IO/EAGAINWaitReadable.html">IO::EAGAINWaitReadable</a></li>
        
          
          
          <li><a href="./IO/EAGAINWaitWritable.html">IO::EAGAINWaitWritable</a></li>
        
          
          
          <li><a href="./IO/EINPROGRESSWaitReadable.html">IO::EINPROGRESSWaitReadable</a></li>
        
          
          
          <li><a href="./IO/EINPROGRESSWaitWritable.html">IO::EINPROGRESSWaitWritable</a></li>
        
          
          
          <li><a href="./IO/EWOULDBLOCKWaitReadable.html">IO::EWOULDBLOCKWaitReadable</a></li>
        
          
          
          <li><a href="./IO/EWOULDBLOCKWaitWritable.html">IO::EWOULDBLOCKWaitWritable</a></li>
        
          
          
          <li><a href="./IO/WaitReadable.html">IO::WaitReadable</a></li>
        
          
          
          <li><a href="./IO/WaitWritable.html">IO::WaitWritable</a></li>
        
          
          
          <li><a href="./IOError.html">IOError</a></li>
        
          
          
          <li><a href="./IndexError.html">IndexError</a></li>
        
          
          
          <li><a href="./Integer.html">Integer</a></li>
        
          
          
          <li><a href="./Interrupt.html">Interrupt</a></li>
        
          
          
          <li><a href="./Kernel.html">Kernel</a></li>
        
          
          
          <li><a href="./KeyError.html">KeyError</a></li>
        
          
          
          <li><a href="./LoadError.html">LoadError</a></li>
        
          
          
          <li><a href="./LocalJumpError.html">LocalJumpError</a></li>
        
          
          
          <li><a href="./Marshal.html">Marshal</a></li>
        
          
          
          <li><a href="./MatchData.html">MatchData</a></li>
        
          
          
          <li><a href="./Math.html">Math</a></li>
        
          
          
          <li><a href="./Math/DomainError.html">Math::DomainError</a></li>
        
          
          
          <li><a href="./Method.html">Method</a></li>
        
          
          
          <li><a href="./Module.html">Module</a></li>
        
          
          
          <li><a href="./Mutex.html">Mutex</a></li>
        
          
          
          <li><a href="./NameError.html">NameError</a></li>
        
          
          
          <li><a href="./NilClass.html">NilClass</a></li>
        
          
          
          <li><a href="./NoMemoryError.html">NoMemoryError</a></li>
        
          
          
          <li><a href="./NoMethodError.html">NoMethodError</a></li>
        
          
          
          <li><a href="./NotImplementedError.html">NotImplementedError</a></li>
        
          
          
          <li><a href="./Numeric.html">Numeric</a></li>
        
          
          
          <li><a href="./Object.html">Object</a></li>
        
          
          
          <li><a href="./ObjectSpace.html">ObjectSpace</a></li>
        
          
          
          <li><a href="./ObjectSpace/WeakMap.html">ObjectSpace::WeakMap</a></li>
        
          
          
          <li><a href="./Proc.html">Proc</a></li>
        
          
          
          <li><a href="./Process.html">Process</a></li>
        
          
          
          <li><a href="./Process/GID.html">Process::GID</a></li>
        
          
          
          <li><a href="./Process/Status.html">Process::Status</a></li>
        
          
          
          <li><a href="./Process/Sys.html">Process::Sys</a></li>
        
          
          
          <li><a href="./Process/UID.html">Process::UID</a></li>
        
          
          
          <li><a href="./Process/Waiter.html">Process::Waiter</a></li>
        
          
          
          <li><a href="./Queue.html">Queue</a></li>
        
          
          
          <li><a href="./Random.html">Random</a></li>
        
          
          
          <li><a href="./Range.html">Range</a></li>
        
          
          
          <li><a href="./RangeError.html">RangeError</a></li>
        
          
          
          <li><a href="./Rational.html">Rational</a></li>
        
          
          
          <li><a href="./Rational/compatible.html">Rational::compatible</a></li>
        
          
          
          <li><a href="./Regexp.html">Regexp</a></li>
        
          
          
          <li><a href="./RegexpError.html">RegexpError</a></li>
        
          
          
          <li><a href="./RubyVM.html">RubyVM</a></li>
        
          
          
          <li><a href="./RubyVM/Env.html">RubyVM::Env</a></li>
        
          
          
          <li><a href="./RubyVM/InstructionSequence.html">RubyVM::InstructionSequence</a></li>
        
          
          
          <li><a href="./RuntimeError.html">RuntimeError</a></li>
        
          
          
          <li><a href="./ScriptError.html">ScriptError</a></li>
        
          
          
          <li><a href="./SecurityError.html">SecurityError</a></li>
        
          
          
          <li><a href="./Signal.html">Signal</a></li>
        
          
          
          <li><a href="./SignalException.html">SignalException</a></li>
        
          
          
          <li><a href="./SizedQueue.html">SizedQueue</a></li>
        
          
          
          <li><a href="./StandardError.html">StandardError</a></li>
        
          
          
          <li><a href="./StopIteration.html">StopIteration</a></li>
        
          
          
          <li><a href="./String.html">String</a></li>
        
          
          
          <li><a href="./Struct.html">Struct</a></li>
        
          
          
          <li><a href="./Symbol.html">Symbol</a></li>
        
          
          
          <li><a href="./SyntaxError.html">SyntaxError</a></li>
        
          
          
          <li><a href="./SystemCallError.html">SystemCallError</a></li>
        
          
          
          <li><a href="./SystemExit.html">SystemExit</a></li>
        
          
          
          <li><a href="./SystemStackError.html">SystemStackError</a></li>
        
          
          
          <li><a href="./Thread.html">Thread</a></li>
        
          
          
          <li><a href="./Thread/Backtrace/Location.html">Thread::Backtrace::Location</a></li>
        
          
          
          <li><a href="./ThreadError.html">ThreadError</a></li>
        
          
          
          <li><a href="./ThreadGroup.html">ThreadGroup</a></li>
        
          
          
          <li><a href="./Time.html">Time</a></li>
        
          
          
          <li><a href="./TracePoint.html">TracePoint</a></li>
        
          
          
          <li><a href="./TrueClass.html">TrueClass</a></li>
        
          
          
          <li><a href="./TypeError.html">TypeError</a></li>
        
          
          
          <li><a href="./UnboundMethod.html">UnboundMethod</a></li>
        
          
          
          <li><a href="./UncaughtThrowError.html">UncaughtThrowError</a></li>
        
          
          
          <li><a href="./ZeroDivisionError.html">ZeroDivisionError</a></li>
        
          
          
          <li><a href="./fatal.html">fatal</a></li>
        
          
          
          <li><a href="./unknown.html">unknown</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div> <!-- metadata -->
  <div class='adzbox'  id="azk83167">
    
   <div id="carbonads-container"><div class="carbonad">
    <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=rubydocorg" 
      id="_carbonads_js">
      </script>
  </div></div>

   
  </div> 
  <div id="documentation">
    <h1 class="module">Marshal</h1>

    <div id="description" class="description">
      
<p>The marshaling library converts collections of Ruby objects into a byte
stream, allowing them to be stored outside the currently active script.
This data may subsequently be read and the original objects reconstituted.</p>

<p>Marshaled data has major and minor version numbers stored along with the
object information. In normal use, marshaling can only load data written
with the same major version number and an equal or lower minor version
number. If Ruby’s “verbose” flag is set (normally using -d, -v, -w, or
–verbose) the major and minor numbers must match exactly. <a
href="Marshal.html">Marshal</a> versioning is independent of Ruby’s version
numbers. You can extract the version by reading the first two bytes of
marshaled data.</p>

<pre class="ruby"><span class="ruby-identifier">str</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-string">&quot;thing&quot;</span>)
<span class="ruby-constant">RUBY_VERSION</span>   <span class="ruby-comment">#=&gt; &quot;1.9.0&quot;</span>
<span class="ruby-identifier">str</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ord</span>     <span class="ruby-comment">#=&gt; 4</span>
<span class="ruby-identifier">str</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">ord</span>     <span class="ruby-comment">#=&gt; 8</span>
</pre>

<p>Some objects cannot be dumped: if the objects to be dumped include
bindings, procedure or method objects, instances of class <a
href="IO.html">IO</a>, or singleton objects, a <a
href="TypeError.html">TypeError</a> will be raised.</p>

<p>If your class has special serialization needs (for example, if you want to
serialize in some specific format), or if it contains objects that would
otherwise not be serializable, you can implement your own serialization
strategy.</p>

<p>There are two methods of doing this, your object can define either
marshal_dump and marshal_load or _dump and _load.  marshal_dump will take
precedence over _dump if both are defined.  marshal_dump may result in
smaller <a href="Marshal.html">Marshal</a> strings.</p>

<h2 id="module-Marshal-label-Security+considerations">Security considerations<span><a href="#module-Marshal-label-Security+considerations">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>By design, <a href="Marshal.html#method-c-load">::load</a> can deserialize
almost any class loaded into the Ruby process. In many cases this can lead
to remote code execution if the <a href="Marshal.html">Marshal</a> data is
loaded from an untrusted source.</p>

<p>As a result, <a href="Marshal.html#method-c-load">::load</a> is not
suitable as a general purpose serialization format and you should never
unmarshal user supplied input or other untrusted data.</p>

<p>If you need to deserialize untrusted data, use JSON or another
serialization format that is only able to load simple, ‘primitive’ types
such as <a href="String.html">String</a>, <a href="Array.html">Array</a>,
<a href="Hash.html">Hash</a>, etc. Never allow user input to specify
arbitrary types to deserialize into.</p>

<h2 id="module-Marshal-label-marshal_dump+and+marshal_load">marshal_dump and marshal_load<span><a href="#module-Marshal-label-marshal_dump+and+marshal_load">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>When dumping an object the method marshal_dump will be called. marshal_dump
must return a result containing the information necessary for marshal_load
to reconstitute the object.  The result can be any object.</p>

<p>When loading an object dumped using marshal_dump the object is first
allocated then marshal_load is called with the result from marshal_dump.
marshal_load must recreate the object from the information in the result.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MyObj</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">data</span>
    <span class="ruby-ivar">@name</span>    = <span class="ruby-identifier">name</span>
    <span class="ruby-ivar">@version</span> = <span class="ruby-identifier">version</span>
    <span class="ruby-ivar">@data</span>    = <span class="ruby-identifier">data</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">marshal_dump</span>
    [<span class="ruby-ivar">@name</span>, <span class="ruby-ivar">@version</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">marshal_load</span> <span class="ruby-identifier">array</span>
    <span class="ruby-ivar">@name</span>, <span class="ruby-ivar">@version</span> = <span class="ruby-identifier">array</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<h2 id="module-Marshal-label-_dump+and+_load">_dump and _load<span><a href="#module-Marshal-label-_dump+and+_load">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Use _dump and _load when you need to allocate the object you’re restoring
yourself.</p>

<p>When dumping an object the instance method _dump is called with an <a
href="Integer.html">Integer</a> which indicates the maximum depth of
objects to dump (a value of -1 implies that you should disable depth
checking).  _dump must return a <a href="String.html">String</a> containing
the information necessary to reconstitute the object.</p>

<p>The class method _load should take a <a href="String.html">String</a> and
use it to return an object of the same class.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MyObj</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">data</span>
    <span class="ruby-ivar">@name</span>    = <span class="ruby-identifier">name</span>
    <span class="ruby-ivar">@version</span> = <span class="ruby-identifier">version</span>
    <span class="ruby-ivar">@data</span>    = <span class="ruby-identifier">data</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">_dump</span> <span class="ruby-identifier">level</span>
    [<span class="ruby-ivar">@name</span>, <span class="ruby-ivar">@version</span>].<span class="ruby-identifier">join</span> <span class="ruby-string">':'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">_load</span> <span class="ruby-identifier">args</span>
    <span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">':'</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Since <a href="Marshal.html#method-c-dump">::dump</a> outputs a string you
can have _dump return a <a href="Marshal.html">Marshal</a> string which is
Marshal.loaded in _load for complex objects.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="MAJOR_VERSION">MAJOR_VERSION</a></dt>
          
          <dd class="description"><p>major version</p></dd>
          
        
          <dt><a name="MINOR_VERSION">MINOR_VERSION</a></dt>
          
          <dd class="description"><p>minor version</p></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="dump-method" class="method-detail ">
          <a name="method-c-dump"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">dump( obj [, anIO] , limit=-1 ) &rarr; anIO</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Serializes obj and all descendant objects. If anIO is specified, the
serialized data will be written to it, otherwise the data will be returned
as a <a href="String.html">String</a>. If limit is specified, the traversal
of subobjects will be limited to that depth. If limit is negative, no
checking of depth will be performed.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Klass</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">str</span>)
    <span class="ruby-ivar">@str</span> = <span class="ruby-identifier">str</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">say_hello</span>
    <span class="ruby-ivar">@str</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>(produces no output)</p>

<pre class="ruby"><span class="ruby-identifier">o</span> = <span class="ruby-constant">Klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;hello\n&quot;</span>)
<span class="ruby-identifier">data</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">o</span>)
<span class="ruby-identifier">obj</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">data</span>)
<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">say_hello</span>  <span class="ruby-comment">#=&gt; &quot;hello\n&quot;</span>
</pre>

<p><a href="Marshal.html">Marshal</a> can't dump following objects:</p>
<ul><li>
<p>anonymous Class/Module.</p>
</li><li>
<p>objects which are related to system (ex: <a href="Dir.html">Dir</a>, <a
href="File/Stat.html">File::Stat</a>, <a href="IO.html">IO</a>, <a
href="File.html">File</a>, Socket and so on)</p>
</li><li>
<p>an instance of <a href="MatchData.html">MatchData</a>, <a
href="Data.html">Data</a>, <a href="Method.html">Method</a>, <a
href="UnboundMethod.html">UnboundMethod</a>, <a href="Proc.html">Proc</a>,
<a href="Thread.html">Thread</a>, <a
href="ThreadGroup.html">ThreadGroup</a>, <a
href="Continuation.html">Continuation</a></p>
</li><li>
<p>objects which define singleton methods</p>
</li></ul>
            

            
            <div class="method-source-code" id="dump-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
marshal_dump(int argc, VALUE *argv)
{
    VALUE obj, port, a1, a2;
    int limit = -1;
    struct dump_arg *arg;
    VALUE wrapper; /* used to avoid memory leak in case of exception */

    port = Qnil;
    rb_scan_args(argc, argv, &quot;12&quot;, &amp;obj, &amp;a1, &amp;a2);
    if (argc == 3) {
        if (!NIL_P(a2)) limit = NUM2INT(a2);
        if (NIL_P(a1)) io_needed();
        port = a1;
    }
    else if (argc == 2) {
        if (FIXNUM_P(a1)) limit = FIX2INT(a1);
        else if (NIL_P(a1)) io_needed();
        else port = a1;
    }
    wrapper = TypedData_Make_Struct(rb_cData, struct dump_arg, &amp;dump_arg_data, arg);
    arg-&gt;dest = 0;
    arg-&gt;symbols = st_init_numtable();
    arg-&gt;data    = st_init_numtable();
    arg-&gt;infection = 0;
    arg-&gt;compat_tbl = 0;
    arg-&gt;encodings = 0;
    arg-&gt;str = rb_str_buf_new(0);
    if (!NIL_P(port)) {
        if (!rb_respond_to(port, s_write)) {
            io_needed();
        }
        arg-&gt;dest = port;
        if (rb_check_funcall(port, s_binmode, 0, 0) != Qundef) {
            check_dump_arg(arg, s_binmode);
        }
    }
    else {
        port = arg-&gt;str;
    }

    w_byte(MARSHAL_MAJOR, arg);
    w_byte(MARSHAL_MINOR, arg);

    w_object(obj, arg, limit);
    if (arg-&gt;dest) {
        rb_io_write(arg-&gt;dest, arg-&gt;str);
        rb_str_resize(arg-&gt;str, 0);
    }
    clear_dump_arg(arg);
    RB_GC_GUARD(wrapper);

    return port;
}
            </pre> 
            </div><!-- dump-source -->
            
          </div>

          

          
        </div><!-- dump-method -->
      
        <div id="load-method" class="method-detail ">
          <a name="method-c-load"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">load( source [, proc] ) &rarr; obj</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the result of converting the serialized data in source into a Ruby
object (possibly with associated subordinate objects). source may be either
an instance of <a href="IO.html">IO</a> or an object that responds to
to_str. If proc is specified, each object will be passed to the proc, as
the object is being deserialized.</p>

<p>Never pass untrusted data (including user supplied input) to this method.
Please see the overview for further details.</p>
            

            
            <div class="method-source-code" id="load-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
marshal_load(int argc, VALUE *argv)
{
    VALUE port, proc;
    int major, minor, infection = 0;
    VALUE v;
    VALUE wrapper; /* used to avoid memory leak in case of exception */
    struct load_arg *arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;port, &amp;proc);
    v = rb_check_string_type(port);
    if (!NIL_P(v)) {
        infection = (int)FL_TEST(port, MARSHAL_INFECTION); /* original taintedness */
        port = v;
    }
    else if (rb_respond_to(port, s_getbyte) &amp;&amp; rb_respond_to(port, s_read)) {
        rb_check_funcall(port, s_binmode, 0, 0);
        infection = (int)FL_TAINT;
    }
    else {
        io_needed();
    }
    wrapper = TypedData_Make_Struct(rb_cData, struct load_arg, &amp;load_arg_data, arg);
    arg-&gt;infection = infection;
    arg-&gt;src = port;
    arg-&gt;offset = 0;
    arg-&gt;symbols = st_init_numtable();
    arg-&gt;data    = st_init_numtable();
    arg-&gt;compat_tbl = 0;
    arg-&gt;proc = 0;
    arg-&gt;readable = 0;

    if (NIL_P(v))
        arg-&gt;buf = xmalloc(BUFSIZ);
    else
        arg-&gt;buf = 0;

    major = r_byte(arg);
    minor = r_byte(arg);
    if (major != MARSHAL_MAJOR || minor &gt; MARSHAL_MINOR) {
        clear_load_arg(arg);
        rb_raise(rb_eTypeError, &quot;incompatible marshal file format (can't be read)\n\
\tformat version %d.%d required; %d.%d given&quot;,
                 MARSHAL_MAJOR, MARSHAL_MINOR, major, minor);
    }
    if (RTEST(ruby_verbose) &amp;&amp; minor != MARSHAL_MINOR) {
        rb_warn(&quot;incompatible marshal file format (can be read)\n\
\tformat version %d.%d required; %d.%d given&quot;,
                MARSHAL_MAJOR, MARSHAL_MINOR, major, minor);
    }

    if (!NIL_P(proc)) arg-&gt;proc = proc;
    v = r_object(arg);
    clear_load_arg(arg);
    RB_GC_GUARD(wrapper);

    return v;
}
            </pre> 
            </div><!-- load-source -->
            
          </div>

          

          
        </div><!-- load-method -->
      
        <div id="restore-method" class="method-detail ">
          <a name="method-c-restore"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">restore( source [, proc] ) &rarr; obj</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          
          <div>
  
            
            <p>Returns the result of converting the serialized data in source into a Ruby
object (possibly with associated subordinate objects). source may be either
an instance of <a href="IO.html">IO</a> or an object that responds to
to_str. If proc is specified, each object will be passed to the proc, as
the object is being deserialized.</p>

<p>Never pass untrusted data (including user supplied input) to this method.
Please see the overview for further details.</p>
            

            
            <div class="method-source-code" id="restore-source">
              <pre> <!-- method.markup_code 290 -->
               static VALUE
marshal_load(int argc, VALUE *argv)
{
    VALUE port, proc;
    int major, minor, infection = 0;
    VALUE v;
    VALUE wrapper; /* used to avoid memory leak in case of exception */
    struct load_arg *arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;port, &amp;proc);
    v = rb_check_string_type(port);
    if (!NIL_P(v)) {
        infection = (int)FL_TEST(port, MARSHAL_INFECTION); /* original taintedness */
        port = v;
    }
    else if (rb_respond_to(port, s_getbyte) &amp;&amp; rb_respond_to(port, s_read)) {
        rb_check_funcall(port, s_binmode, 0, 0);
        infection = (int)FL_TAINT;
    }
    else {
        io_needed();
    }
    wrapper = TypedData_Make_Struct(rb_cData, struct load_arg, &amp;load_arg_data, arg);
    arg-&gt;infection = infection;
    arg-&gt;src = port;
    arg-&gt;offset = 0;
    arg-&gt;symbols = st_init_numtable();
    arg-&gt;data    = st_init_numtable();
    arg-&gt;compat_tbl = 0;
    arg-&gt;proc = 0;
    arg-&gt;readable = 0;

    if (NIL_P(v))
        arg-&gt;buf = xmalloc(BUFSIZ);
    else
        arg-&gt;buf = 0;

    major = r_byte(arg);
    minor = r_byte(arg);
    if (major != MARSHAL_MAJOR || minor &gt; MARSHAL_MINOR) {
        clear_load_arg(arg);
        rb_raise(rb_eTypeError, &quot;incompatible marshal file format (can't be read)\n\
\tformat version %d.%d required; %d.%d given&quot;,
                 MARSHAL_MAJOR, MARSHAL_MINOR, major, minor);
    }
    if (RTEST(ruby_verbose) &amp;&amp; minor != MARSHAL_MINOR) {
        rb_warn(&quot;incompatible marshal file format (can be read)\n\
\tformat version %d.%d required; %d.%d given&quot;,
                MARSHAL_MAJOR, MARSHAL_MINOR, major, minor);
    }

    if (!NIL_P(proc)) arg-&gt;proc = proc;
    v = r_object(arg);
    clear_load_arg(arg);
    RB_GC_GUARD(wrapper);

    return v;
}
            </pre> 
            </div><!-- restore-source -->
            
          </div>

          

          
        </div><!-- restore-method -->
      
      </div><!-- public-class-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  
  <div id='tx_Marshal_versioned' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_Marshal_versioned").load("/associated/2.2.0/Marshal.ihtml");</script> <div id='tx_Marshal' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_Marshal").load("/associated/Marshal.ihtml");</script> 
      
  <!-- dsqus ? -->
     

  
  </div><!-- documentation -->
  <div id='dynamic'>
  </div>
      
          

      
<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 2.2.0</small></p> 
  
   <p><a href="http://ruby-doc.org">Ruby-doc.org</a> is provided by <a href="http://jamesbritt.com">James Britt</a> and <a href="http://neurogami.com">Neurogami</a>. <a href="http://neurogami.com">Maximum R+D</a>.  <div class='oio-inline'><ins data-revive-zoneid="1" data-revive-id="58924a5717c091dfee6dda3f7d38c4d7"></ins><script async src="//ras.ruby-doc.org/vvv/delivery/thesinkjs.php"></script></div></p>
 
       <p><small>Generated with Ruby-doc Rdoc Generator 0.39.0</small>.</p>
  </div>
</div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-335317-2', 'auto');
  ga('send', 'pageview');

</script>


    
 <script type='text/javascript'>
$(document).ready(function() {
      $.ajaxSetup({ cache: false });
      $("#vulns-alert").load("/associated/vulns.ihtml");
    });

    </script>


 
		<script type='text/javascript'>

	function loadPlus(plusdocs){
			$(plusdocs).find("div[class='associated_wrapper']").each (function() {
					$("#" + this.id).append($(plusdocs).find("#" + this.id ));
					});
	} 

   //function loadInline(json){
   // for (var lookFor in json) {
    //  $(lookFor).after(json[lookFor]);
    // }
  // } // end loadInline


$(document).ready(function() {
		$.ajaxSetup({ cache: false });
			$.get('/associated/2.2.0/plus_Marshal.ihtml', 
			function(plusdocs) {
			setTimeout(function() {
				loadPlus(plusdocs);
				}, 2000);
			}
			);


//     $.ajax({
//     dataType: "json",
//      url: '/associated/2.2.0/inline_Marshal.js',
//      success: function(json) {
// 			setTimeout(function() {
// 				loadInline(json);
// 				}, 2000);
// 			}
//    });

		});
</script>
		
</body>
</html>


